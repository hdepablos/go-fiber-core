package routes

import (
	"go-fiber-core/internal/dtos/requests"
	"go-fiber-core/internal/handlers"
	"go-fiber-core/internal/utils"

	fiber "github.com/gofiber/fiber/v2"
)

func RegisterMenuRoutes(router fiber.Router, menuHandler handlers.MenuHandler) {
	menuGroup := router.Group("/menus")

	// --- RUTAS DE ESCRITURA (Comandos) ---

	// POST /menus - Crear un nuevo ítem del menú
	menuGroup.Post(
		"/",
		utils.Validate(new(requests.CreateMenuRequest)),
		menuHandler.Create,
	)

	// DELETE /menus/:id - Borrado lógico de un ítem del menú
	menuGroup.Delete("/:id", menuHandler.SoftDelete)

	// POST /menus/:id/roles - Asociar roles a un ítem del menú
	menuGroup.Post(
		"/:id/roles",
		utils.Validate(new(requests.AddRolesRequest)),
		menuHandler.AddRoles,
	)

	// DELETE /menus/:id/roles - Eliminar asociaciones de roles con un ítem del menú
	menuGroup.Delete("/:id/roles", menuHandler.RemoveRoles)

	menuGroup.Post(
		"/roles/bulk",
		utils.Validate(new(requests.BulkAddRolesToMenusRequest)),
		menuHandler.BulkAddRoles,
	)

	menuGroup.Delete("/roles/bulk", menuHandler.BulkRemoveRoles)
}
