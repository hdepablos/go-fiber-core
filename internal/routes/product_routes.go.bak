// internal/routes/product_routes.go
package routes

import (
	"go-fiber-core/internal/dtos/requests"
	"go-fiber-core/internal/handlers"
	"go-fiber-core/internal/utils"

	fiber "github.com/gofiber/fiber/v2"
)

// RegisterProductRoutes define todos los endpoints relacionados con el recurso de Productos.
func RegisterProductRoutes(router fiber.Router, productHandler handlers.ProductHandler) {
	productGroup := router.Group("/products")

	// --- RUTAS DE ESCRITURA (Comandos) ---

	// POST /products - Crear un nuevo producto
	productGroup.Post(
		"/",
		utils.Validate(new(requests.CreateProductRequest)),
		productHandler.Create,
	)

	// POST /products/bulk - Crear múltiples productos (bulk insert)
	productGroup.Post(
		"/bulk",
		utils.Validate(new(requests.BulkCreateProductsRequest)),
		productHandler.BulkInsertProducts,
	)

	// PUT /products/:id - Actualizar un producto existente
	productGroup.Put(
		"/:id",
		utils.Validate(new(requests.UpdateProductRequest)),
		productHandler.Update,
	)

	// DELETE /products/:id - Borrado lógico
	productGroup.Delete("/:id", productHandler.SoftDelete)

	// DELETE /products/hard/:id - Borrado físico
	productGroup.Delete("/hard/:id", productHandler.HardDelete)

	// --- RUTAS DE LECTURA (Consultas) ---

	// GET /products - Obtener todos los productos
	productGroup.Get("/", productHandler.GetAll)

	// GET /products/:id - Obtener un producto por ID
	productGroup.Get("/:id", productHandler.GetByID)

	// POST /products/paginated - Obtener productos paginados
	productGroup.Post("/paginated", productHandler.GetAllPaginated)

	// --- NUEVAS RUTAS DE CONFIG ---
	productGroup.Get("/config/redis", productHandler.PrintRedisConfig)
	productGroup.Get("/config/service", productHandler.PrintServiceConfigs)
}
